%
% Modified by Sameer Vijay
% Last Change: Wed Jul 27 2005 13:00 CEST
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Sample Notre Dame Thesis/Dissertation
% Using Donald Peterson's ndthesis classfile
%
% Written by Jeff Squyres and Don Peterson
%
% Provided by the Information Technology Committee of
%   the Graduate Student Union
%   http://www.gsu.nd.edu/
%
% Nothing in this document is serious except the format.  :-)
%
% If you have any suggestions, comments, questions, please send e-mail
% to: ndthesis@gsu.nd.edu
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%
% Chapter 4
%

\chapter{DATA ANALYSIS}
\label{chap:dataAnalysis}
\begin{comment}
We care about two things:
1. The absolute cross-section of the ground state transition
2. Setting a limit on excited 0+ state cross-sections
\end{comment}
The aim of the data analysis of the \reaction data sets is to extract the absolute cross-section of the reaction populating the ground state of \GeTargets and also to set a limit on excited \zp state cross-sections.  Each of these analyses is discussed in its own section, but because the absolute cross-section is of interest, the detector efficiency and several properties of the experiment must be accurately determined.  The detector efficiency is discussed first.

\section{Detector Efficiency}
\begin{comment}
deuterium, Mg, cuts
\end{comment}
The measurement made by the neutron detector is counts - counts of neutrons of differing energies.  The number of counts due to neutrons made by the neutron detector scales linearly with the absolute cross-section of \reaction but is not identical to it because not all the neutrons produced leave a signal in the detector.  The ratio of the detected neutron flux to the total neutron flux is called the efficiency of a detector and must be carefully determined as its error contributes directly to the systematic uncertainty of the extracted absolute cross-sections.

A particularly robust method of determining detector efficiency is to measure a well-known cross-section.  Comparing the measured cross-section with the accepted value gives the efficiency of the detector.  In the case of the neutron detector, the efficiency is expected to change with the energy of the neutron, making it important to measure a cross-section that is well-known with neutron energies near 26~MeV, the expected neutron energy of \reaction.  Two promising reactions are \DuReaction and \MgReaction, which have not been measured at the needed energy but have been measured at surrounding energies.  The existing measurements are shown in {\tab}~\ref{tab:efficiencyCalib}. DWBA calculations can reliably interpolate expected cross-sections at appropriate beam energies for 26~MeV neutrons, providing two independent checks on the detector efficiency for \reaction.



\section{Experimental Parameters Related to the Cross Section}
\begin{comment}
current, tgt thickness (RBS), solid angle, dead time
go ahead and discuss errors while you discuss these quantities
\end{comment}

The absolute cross section is the number of times a reaction occurred normalized by the total number of particles incident on the target and the number density of nuclei in the target:
\begin{align}
\text{cross section} &= \frac{\text{times reaction occurred}}{\text{particles incident on target} \times \text{number density of target nuclei}} \\
                     &= \frac{\text{times reaction occurred}}{\text{particle current} \times \text{time} \times \text{target thickness}}
\label{eq:cross_section}
\end{align}
The interest in this experiment is the differential cross-section, the cross-section as a function of angle.  Extracting the number of times the reaction occurred at each angle will be discussed in future sections.  The quantities in the cross-section that relate to the experimental setup are the number of particles incident on the target and the number density of nuclei in the target.

Three targets were used in the experiments.  \GeTargets and \Mg{26} targets were provided by ??.  Their isotopic abundance and thickness is shown in {\tab}~\ref{tab:targets}.  The target thicknesses were measured when they were made and again at Hope College using Rutherford back-scattering (RBS).  The reported thickness were obtained by analyzing the RBS data with SIMNRA \cite{SIMNRA}, RBS analysis software.  To understand variations in target thickness, measurements were taken at several different positions on each target.  A sample of the fit for each target is shown in {\fig}~\ref{fig:RBS_sample}.

To determine the absolute cross-section, it is also necessary to know the total number of \He{3} incident on the target for each dataset.  One monitor of the beam current is the charge collected by the Faraday cup.  A NaI$_2$ crystal outside the target chamber and a silicon detector inside the target chamber detect $\gamma$ radiation from beam incident on the target and scattered \He{3} beam, respectively.  Both these detectors monitor the product of the target thickness and the beam current.  Data from the silicon detector show that the ratio of the \GeTargets to gold does not change throughout the run and that the live charge collected by the Faraday cup scales with the back-scattered peak in the silicon spectrum.  This means that the live charge can be used to scale beam current between runs, allowing us to express \reaction cross-sections in terms of the known \MgReaction.

\section{Data Sets}
Two sets of \reaction data are available.  The first was taken in September of 2011.  A subset of this data was taken with no pulse selection due to hardware failure.  A second run in December of 2011 provided additional data, all taken with pulse selection.  During the December run, data was taken with the \GeTargets as well as the \Mg{26} target to provide an accurate normalization for the detector.  The data sets are summarized in {\tab}~\ref{tab:dataSets}.

\section{Cuts}
Three sets of cuts are applied to the data to generate a final data set.  The first cut verifies that the recorded event represents a real event.  The next cut checks that the event is not a muon event.  The last cut is an energy cut that discards low-energy signals, reducing the background due to $\gamma$ radiation.

A true event should have energy above the noise level recorded in both top and bottom PMT's and the time signals from the top and bottom PMT's should be correlated.  A typical energy spectrum with no cuts applied and a typical scatter plot of top and bottom timing are shown in {\fig}~\ref{fig:realEvent}.  These cuts are applied during initial data processing and the results are stored with the event as an array of correlations.  All bars having an event that appears valid will have a ``true'' entry in the correlation array.  Requiring a bar to have a correlation is a cut that is applied to all final data sets.

A first approximation to determining whether or not an event is the result of a muon interaction is to require all but one bar in the neutron detector, as well as the entire veto, to be silent.  However, this would veto events that are spatially disconnected and could not possibly be due to a single muon.  To eliminate these unnecessary vetoes, we look at events that register signals in material with close spatial proximity.  One way to determine the appropriateness of increasing the size of a veto group is by looking at the energy spectrum of the additional vetoed events.  Adding material to a veto group that primarily vetoes muons results in an energy spectrum that has roughly even numbers of high and low energy events, as shown in {\fig}~\ref{fig:muonVetoSpectrum}.  Material that is too far away and does not veto primarily muon events will veto events whose energy spectrum appears much more like the room background spectrum, heavily weighted towards lower energy events, as in {\fig}~\ref{fig:notMuonVetoSpectrum}.  Examining these figures for each bar indicates that an appropriate group of material to use in the veto is the material immediately surrounding the detector bar.  Several samples of veto groups are shown in {\fig}~\ref{fig:vetoGroups}.

An additional restriction that eliminates muon events is to discard events that deposit energy above the maximum neutron energy deposition.    

The final cut on the data sets is a lower energy cut to reduce the random background due to $\gamma$ radiation.  Such a cut discards neutrons, which are also likely to deposit a small amount of energy, and it is necessary to calculate where the energy cut maximizes the signal to noise ratio.  An important feature of the energy cut is that it is strongly position dependent.  It is appealing to argue that light loss due to attenuation must be exponential, and that an accurate estimator of the total deposited energy is obtained from the product of the signals seen by the top and bottom PMT:
\begin{equation}
A\exp{-\alpha x}\times A\exp{-\alpha (L-x)} = A^2\exp{-\alpha L},
\end{equation}
where $\alpha$ is a factor that determines the attenuation in the bar and $L$ is its length.  Modeling the position dependence of the signals in the bar as an exponential, then, implies that the product of the signals should be position-independent, when in fact it is not, as seen in {\fig}~\ref{fig:product_positionDependence}.  The position dependence is not uniform from bar to bar, making a cut requiring the product to be greater than some constant introduce significant systematic error into the final cross-section.

A different way to approach the energy cut is to place a position-dependent cut on each PMT separately using the energy vs. position spectrum of the vetoed events.  These events are likely to be muons, and because muons have an angular distribution of ??, there is a most-likely angle that muons take through the neutron detector bars.  This most-likely path length manifests as a peak in the energy spectrum that depends only on the thickness of the bars and on the most likely angle of incident muons, both of which are the same for every bar in the neutron wall.  A simulated energy spectrum is shown next to a real energy spectrum in {\fig}~\ref{fig:muonSpectrum}.  The peak of this energy spectrum as a function of position, then, serves as a calibration at every position and is a suitable candidate for an energy cut.  Fits to the location of the energy peak as a function of position are shown in {\fig}~\ref{fig:fits_pkVSpos}.

Using the energy peak as a function of position itself as a lower energy cut, however, results in an energy cut that is too high as can be seen in {\fig}~\ref{fig:highEnergyCut}.  Instead, these cuts are scaled to maximize the signal to noise ratio.  There is no reason to assume that all energy cuts will scale in the same way, and the appropriate ratios are determined by comparing background reduction to the initial cut as in {\fig}~\ref{fig:scalingFactor}.  An additional concern is that simply scaling the energy cut may not provide an accurate position dependence.  No distinct feature exists at lower energies, making this difficult to directly check.  However, the position distribution of rejected events with these scaled energy cuts is flat as in {\fig}~\ref{fig:flatPositionSpectrum}, suggesting that the position dependence is still a reasonable approximation for lower-energy events.

\section{Ground State Cross-Section}
\subsection{Background Subtraction}
\begin{comment}
two data sets
- pulse selection
- no pulse selection

background
- gamma peaks - do not overlap with neutron peak
- other neutron peaks - ??
- randoms - background in both data sets
- continuum - more important in non-pulse-selected data

extracting counts 
- pulse selection
- no pulse selection
\end{comment}

The data sets for this analysis were gathered in two separate runs; the pulse selector was not working for part of the first run.  Analysis of the datasets taken with pulse selection is straightforward and will be discussed first.  Without pulse selection, the neutron peak sits on top of background from previous neutron bunches.  The background fit is different and the total counts have a larger systematic uncertainty; extracting these will be discussed second.

\subsection{Pulse-Selected Data}
Consider the signals that build the TOF spectrum.  Random background radiation can occur at any time with respect to the beam bunch.  In fact, it should have no knowledge of the beam bunch and is equally likely to occur at every time after a beam bunch.  In other words, the TOF spectrum of background radiation should be flat.  Taking a TOF spectrum with no beam confirms this.

%figure of beam-off TOF spectrum

The neutrons coming from the ground state of \As{78} are mono-energetic and should come at a fixed time relative to the beam bunch; counts from these neutrons should form a peak that is approximately as narrow in time as the beam bunch.  Looking a a beam-on TOF spectrum, it is clear that the neutron peak and the flat background are not the only features.

% figure of beam-on TOF spectrum

The other prominent features of this spectrum are peaks from gammas produced when the beam hits the target and also neutrons from excited states as well as a broad neutron evaporation spectrum from multiple-channel interactions.

In the case of the pulse-selected data, the background that overlaps with the neutron peak of interest is well-determined.  The gamma peaks are far away from the neutron peak and have no effect.  Wonderfully, the broad, flat region enables a very precise estimate of the random background level.  The neutron evaporation peak is the least-well understood contributor to the background of the ground state neutron peak and will be discussed later.  For now, we focus on the simplest contribution to the background, the flat distribution due to randoms.

In general, extracting the counts due to the neutrons is simple:

\begin{equation}
\text{Sum(peak region) - Background(peak region)}
\label{eq:counts}
\end{equation}

With an associated error

\begin{equation}
\sqrt{\sigma_{Sum}^2 + \sigma_{background}^2}
\label{eq:errDef}
\end{equation}

The sum of counts in a fixed region can be understood as a random variable; as such, its error is $\sqrt{N_{\text{peakregion}}}$.  This is quite large - is there an extraction method that will reduce this error?  The two most straightforward options available to a physicist bent on extracting counts due to a signal are sideband subtraction and fitting.  Fitting when the background is not understood can lead to systematic errors, while sideband subtraction's accuracy depends on a background that does not change rapidly near the signal region.  With these data sets, the number of signal counts is very small compared to the background.  Using sideband subtraction introduces another random variable and increases the width of the distribution of extracted counts for a given bar.  In the case of the pulse-selected data, there is no need to introduce this additional statistical error because the flat background is determined to within ??\%, so that using the fitted value is much more like introducing a constant into the equation for the extracted counts, improving the fractional error by almost a factor of $\sqrt{2}$.  See \fig \ref{fig:statDist} to see the effect of using the fitted value on the width of the extracted count distribution.

\begin{equation}
Counts = Sum(peak region) - Fitted Constant * number of Bins
\sigma^2 = Sum + fit error
\label{eq:fitErr}
\end{equation}

\begin{figure}[ht]
\centering
  \subfloat[Distribution of Background Counts][Distribution of Background Counts]{
  \includegraphics[width=0.3\textheight]{figures/bkgDist}
  \label{fig:bkgDist}}
  
  \subfloat[Distribution of Signal Counts][Distribution of Signal Counts]{
  \includegraphics[width=0.3\textheight]{figures/sigDist}
  \label{fig:sigDist}}
  
  \subfloat[Distribution of Extracted Counts][Distribution of Extracted Counts]{
  \includegraphics[width=0.3\textheight]{figures/extractDist}
  \label{fig:extractDist}}

  \caption{The number of counts in the peak region are a sum of the number of counts in the random background and counts from the neutrons.  The width of a sample at a uniform rate is simply sqrt(N), as seen in figure ??.  This is an appropriate description of the random background.  The neutron peak is roughly gaussian-shaped, and running trials where counts are drawn from a gaussian distribution shows that the width is ??.}
  \label{fig:statDist}
\end{figure}

The error introduced to the extracted counts depends on how the background is determined.  In the case of the pulse-selected data, it is clearly better to fit the background.  The constant component of the background is well-determined and contributes a tiny ??\% to the total error.  The evaporation spectrum is not as well constrained and introduces ??\% to the total error.  Even with the uncertainty in the evaporation spectrum fit, the improvement in the error compared to sideband subtraction is a factor of ??.

\subsection{Pulse-Selected Data}
With pulse selection, the region behind the neutron peak has only random signal and can be fit with a constant to within ??\%.  Assuming that the neutron peak itself does not overlap with other background, the total number of counts is estimated as the direct sum of the bin contents minus the average bin content of the background region.  In this case, the error should be the statistical error associated with the random background in the peak region and the statistical error associated with the counts in the neutron peak, added in quadrature.  Such an error neglects the error associated with the constant that is fit, appropriate in this case because it influences the error by at most 0.1\%.

When considering the error, it should be considered that the neutron peak itself may be sitting on top of signal from processes that result in lower-energy neutrons.  A neutron continuum is clearly visible in all targets, and while in 26Mg the continuum is separated by ?? MeV, it is difficult to determine where the continuum for the 76Se and 78Se stops.  What is safe to assume is that neutrons populating the continuum cannot have an energy greater than the \zp neutron, and so its endpoint cannot extend past the center of the ground state neutron distribution.  Functional models that fit the shape of the continuum well are the Beta Distribution and also the Gamma Distribution.  Both these functions give similar estimates of the background under the neutron peak; the effect is not greater than ??\% even in the largest peaks.

\subsection{Data with No Pulse Selection}
With no pulse selection, the neutron peak sits on top of background from the previous bunch.  Every portion of this spectrum sees beam; without a section that only consists of background, fitting is much more difficult. (quantify this!)

Fitting this spectrum by itself suffers from significant uncertainty in the height of the evaporation spectrum because the flat background is not well-constrained by any portion of the spectrum.

% figure of fit to solo hist?

But wait!  The pulse-selected histogram should have the same shape to its evaporation spectrum as the non-pulse-selected data from the same bar.  Fitting to the pulse-selected and non-pulse-selected histogram simultaneously greatly improves the uncertainty.  The model for the pulse-selected data is

% equation for pulse-selected spectrum
\begin{equation}
Beta(A,B,\alpha,\beta) + Gaus() + Gaus() + Gaus() + DoubleGaus() + Const
\end{equation}

% equation for non-pulse-selected spectrum
\begin{equation}
Beta(A,B,\alpha,\beta) + Gaus() + Gaus() + Gaus() + DoubleGaus() + Const
\end{equation}

Where certainly the parameters of the Beta Distribution must be the same for each histogram.  But these two histograms constrain each other in more ways than just the shape of the neutron evaporation spectrum.  A detector sitting at the same angle should see the same ratio between neutrons from the evaporation peak, neutrons from the Carbon peak, and neutrons from the 0+ peak.  The full neutron spectra - peaks and evaporation region - from each of these histograms should have the same shape.  So now the model for the non-pulse-selected spectrum can be a neutron spectrum that's a scaled copy of the pulse-selected spectrum's neutron spectrum.

% equation for pulse-selected spectrum
\begin{equation}
Neut_{PS} + DoubleGaus() + Const
\end{equation}

% equation for non-pulse-selected spectrum
\begin{equation}
R*Neut_{PS} + DoubleGaus() + Const
\end{equation}

Restricting the fixed scaling to the neutrons alone, however, is incorrect.  The detector, sitting at its designated angle, sees the same mix of neutrons as well as the same mix of neutrons and gammas.  There are really two spectra the detector sees - a beam-related spectrum and the non-beam-related background spectra.  Two different runs will provide these in different ratios; for example, a short run with high beam current would proved more beam-related spectrum and little background spectrum, while a long run with low beam current would provide provide moderate beam-related spectrum and much background spectrum.  The appropriate model for fitting the two datasets simultaneously, then, is

% equation for pulse-selected spectrum
\begin{equation}
Neut_{PS} + Gamma_{PS} + Const_{PS}
\end{equation}

% equation for non-pulse-selected spectrum
\begin{equation}
R(Neut_{PS} + Gamma_{PS}) + Const_{NPS}
\end{equation}

That the gamma peaks scale by the same ratio as the neutron peaks is a significant constraint on this fit because they are such pronounced features.  Quantitative results?  Such a fit does indeed converge well for a large majority of the detectors.  A dedicated fitter may begin to wonder if there are as-yet-unused constraints that could provide an even more robust fit that would ensure a convergent fit for all angles.

One additional constraint concerns the ratio between the two datasets.  This ratio scales the amount of beam seen by one bar during the two data runs.  But each bar should see the same ratio!  Fitting all the bars simultaneously will provide a much-improved ratio.

% figure of two-hist fit?



\section{Placing a limit on excited 0+ state cross-sections}
\begin{comment}
introduce 0+ peak and see when it becomes statistically significant
there will be different limits for different energies!  because of the evaporation background
\end{comment}

\section{Fitting 0+ ground state}
\begin{comment}
DWBA calculation
shell model
f$^2$, p$^2$ state strength ("form factor")
\end{comment}

\section{Implications for \zvbb NME}
\begin{comment}
Okay I'm not really sure how to figure this out
\end{comment}

% % uncomment the following lines,
% if using chapter-wise bibliography
%
% \bibliographystyle{ndnatbib}
% \bibliography{example}
